<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zz.HttpClient.modules.assetManage.dao.AiCollectionDao">
	
	<!-- 接通率统计(时间) -->
	<select id="connectionRateStatisticsByTime" resultType="AiCollectionResult">
		SELECT 
			TOT.TOTAL,
			SUC.SUC_NUM
		FROM 
		(SELECT COUNT(*) AS TOTAL 
			FROM [Message].[dbo].[COLLECTION_RESULT] 
			WHERE DATEDIFF(DD,INSERT_TIME,#{date}) = 0 AND DATEPART(hh,INSERT_TIME) = #{hour}) TOT,
		(SELECT COUNT(*) AS SUC_NUM
			FROM [Message].[dbo].[COLLECTION_RESULT]
			WHERE DATEDIFF(DD,INSERT_TIME,#{date}) = 0 AND DATEPART(hh,INSERT_TIME) = #{hour} AND RESULT IN (0,15,16)) SUC
	</select>
	
</mapper>